version: 1
frontend:
  phases:
    preBuild:
      commands:
        - npm ci
    build:
      commands:
        - npm run build
  artifacts:
    baseDirectory: .next
    files:
      - '**/*'

test:
  phases:
    preTest:
      commands:
        - npm ci
        - wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | sudo apt-key add - 
        - sudo sh -c 'echo "deb https://dl.google.com/linux/chrome/deb/ stable main" >> /etc/apt/sources.list.d/google.list'
        - sudo apt-get update -y -q --force-yes
        - sudo apt-get install -y -q --force-yes google-chrome-stable
    test:
      commands:
        - 'npx wdio run ./wdio.conf.js'
  artifacts:
    baseDirectory: /
    configFilePath: '**/mochawesome.json'
    files:
      - '**/*.png'
      - '**/*.mp4'